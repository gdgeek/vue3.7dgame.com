import{cb as e,Y as n,K as o,_ as t,d as a,a0 as s,E as l,cc as r,bO as i,c,r as u,X as d,cd as p,au as f,ce as m,ae as g,I as v,o as b,a8 as h,bb as y,ab as C,e as E,f as x,w,Z as B,l as k,B as M,i as I,n as T,j as L,h as R,C as S,p as _,D as z,$ as A,k as O,a1 as P,a4 as V,T as $,H as j,M as K,bR as H,bF as D,O as U,ar as q,bf as F,be as Z,bK as Y}from"./index.D_6c1BO-.js";import{E as W}from"./index.D3735v7o.js";import{E as X,u as G,a as J,b as N}from"./index.BtcHjPUK.js";import{o as Q}from"./aria.D6AGjDMk.js";import{E as ee}from"./index.C9igdc6f.js";const ne=n=>["",...e].includes(n),oe="_trap-focus-children",te=[],ae=e=>{if(0===te.length)return;const n=te[te.length-1][oe];if(n.length>0&&e.code===o.tab){if(1===n.length)return e.preventDefault(),void(document.activeElement!==n[0]&&n[0].focus());const o=e.shiftKey,t=e.target===n[0],a=e.target===n[n.length-1];t&&o&&(e.preventDefault(),n[n.length-1].focus()),a&&!o&&(e.preventDefault(),n[0].focus())}};var se=t(a({name:"ElMessageBox",directives:{TrapFocus:{beforeMount(e){e[oe]=Q(e),te.push(e),te.length<=1&&document.addEventListener("keydown",ae)},updated(e){n((()=>{e[oe]=Q(e)}))},unmounted(){te.shift(),0===te.length&&document.removeEventListener("keydown",ae)}}},components:{ElButton:s,ElFocusTrap:ee,ElInput:W,ElOverlay:X,ElIcon:l,...r},inheritAttrs:!1,props:{buttonSize:{type:String,validator:ne},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:o}){const{locale:t,zIndex:a,ns:s,size:l}=i("message-box",c((()=>e.buttonSize))),{t:r}=t,{nextZIndex:C}=a,E=u(!1),x=d({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:p(f),cancelButtonLoadingIcon:p(f),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:C()}),w=c((()=>{const e=x.type;return{[s.bm("icon",e)]:e&&m[e]}})),B=g(),k=g(),M=c((()=>x.icon||m[x.type]||"")),I=c((()=>!!x.message)),T=u(),L=u(),R=u(),S=u(),_=u(),z=c((()=>x.confirmButtonClass));v((()=>x.inputValue),(async o=>{await n(),"prompt"===e.boxType&&null!==o&&K()}),{immediate:!0}),v((()=>E.value),(o=>{var t,a;o&&("prompt"!==e.boxType&&(x.autofocus?R.value=null!=(a=null==(t=_.value)?void 0:t.$el)?a:T.value:R.value=T.value),x.zIndex=C()),"prompt"===e.boxType&&(o?n().then((()=>{var e;S.value&&S.value.$el&&(x.autofocus?R.value=null!=(e=H())?e:T.value:R.value=T.value)})):(x.editorErrorMessage="",x.validateError=!1))}));const A=c((()=>e.draggable)),O=c((()=>e.overflow));function P(){E.value&&(E.value=!1,n((()=>{x.action&&o("action",x.action)})))}G(T,L,A,O),b((async()=>{await n(),e.closeOnHashChange&&window.addEventListener("hashchange",P)})),h((()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",P)}));const V=()=>{e.closeOnClickModal&&j(x.distinguishCancelAndClose?"close":"cancel")},$=N(V),j=n=>{var o;("prompt"!==e.boxType||"confirm"!==n||K())&&(x.action=n,x.beforeClose?null==(o=x.beforeClose)||o.call(x,n,x,P):P())},K=()=>{if("prompt"===e.boxType){const e=x.inputPattern;if(e&&!e.test(x.inputValue||""))return x.editorErrorMessage=x.inputErrorMessage||r("el.messagebox.error"),x.validateError=!0,!1;const n=x.inputValidator;if("function"==typeof n){const e=n(x.inputValue);if(!1===e)return x.editorErrorMessage=x.inputErrorMessage||r("el.messagebox.error"),x.validateError=!0,!1;if("string"==typeof e)return x.editorErrorMessage=e,x.validateError=!0,!1}}return x.editorErrorMessage="",x.validateError=!1,!0},H=()=>{const e=S.value.$refs;return e.input||e.textarea},D=()=>{j("close")};return e.lockScroll&&J(E),{...y(x),ns:s,overlayEvent:$,visible:E,hasMessage:I,typeClass:w,contentId:B,inputId:k,btnSize:l,iconComponent:M,confirmButtonClasses:z,rootRef:T,focusStartRef:R,headerRef:L,inputRef:S,confirmRef:_,doClose:P,handleClose:D,onCloseRequested:()=>{e.closeOnPressEscape&&D()},handleWrapperClick:V,handleInputEnter:e=>{if("textarea"!==x.inputType)return e.preventDefault(),j("confirm")},handleAction:j,t:r}}}),[["render",function(e,n,o,t,a,s){const l=C("el-icon"),r=C("close"),i=C("el-input"),c=C("el-button"),u=C("el-focus-trap"),d=C("el-overlay");return E(),x($,{name:"fade-in-linear",onAfterLeave:n=>e.$emit("vanish"),persisted:""},{default:w((()=>[B(k(d,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:w((()=>[M("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:I(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[k(u,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:w((()=>[M("div",{ref:"rootRef",class:I([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:T(e.customStyle),tabindex:"-1",onClick:L((()=>{}),["stop"])},[null!==e.title&&void 0!==e.title?(E(),R("div",{key:0,ref:"headerRef",class:I([e.ns.e("header"),{"show-close":e.showClose}])},[M("div",{class:I(e.ns.e("title"))},[e.iconComponent&&e.center?(E(),x(l,{key:0,class:I([e.ns.e("status"),e.typeClass])},{default:w((()=>[(E(),x(S(e.iconComponent)))])),_:1},8,["class"])):_("v-if",!0),M("span",null,z(e.title),1)],2),e.showClose?(E(),R("button",{key:0,type:"button",class:I(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:A(L((n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),["prevent"]),["enter"])},[k(l,{class:I(e.ns.e("close"))},{default:w((()=>[k(r)])),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):_("v-if",!0)],2)):_("v-if",!0),M("div",{id:e.contentId,class:I(e.ns.e("content"))},[M("div",{class:I(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(E(),x(l,{key:0,class:I([e.ns.e("status"),e.typeClass])},{default:w((()=>[(E(),x(S(e.iconComponent)))])),_:1},8,["class"])):_("v-if",!0),e.hasMessage?(E(),R("div",{key:1,class:I(e.ns.e("message"))},[O(e.$slots,"default",{},(()=>[e.dangerouslyUseHTMLString?(E(),x(S(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(E(),x(S(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:w((()=>[P(z(e.dangerouslyUseHTMLString?"":e.message),1)])),_:1},8,["for"]))]))],2)):_("v-if",!0)],2),B(M("div",{class:I(e.ns.e("input"))},[k(i,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":n=>e.inputValue=n,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:I({invalid:e.validateError}),onKeydown:A(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),M("div",{class:I(e.ns.e("errormsg")),style:T({visibility:e.editorErrorMessage?"visible":"hidden"})},z(e.editorErrorMessage),7)],2),[[V,e.showInput]])],10,["id"]),M("div",{class:I(e.ns.e("btns"))},[e.showCancelButton?(E(),x(c,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:I([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:n=>e.handleAction("cancel"),onKeydown:A(L((n=>e.handleAction("cancel")),["prevent"]),["enter"])},{default:w((()=>[P(z(e.cancelButtonText||e.t("el.messagebox.cancel")),1)])),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):_("v-if",!0),B(k(c,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:I([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:n=>e.handleAction("confirm"),onKeydown:A(L((n=>e.handleAction("confirm")),["prevent"]),["enter"])},{default:w((()=>[P(z(e.confirmButtonText||e.t("el.messagebox.confirm")),1)])),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[V,e.showConfirmButton]])],2)],14,["onClick"])])),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])])),_:3},8,["z-index","overlay-class","mask"]),[[V,e.visible]])])),_:3},8,["onAfterLeave"])}],["__file","index.vue"]]);const le=new Map,re=(e,n,o=null)=>{const t=k(se,e,Z(e.message)||H(e.message)?{default:Z(e.message)?e.message:()=>e.message}:null);return t.appContext=o,D(t,n),(e=>{let n=document.body;return e.appendTo&&(K(e.appendTo)&&(n=document.querySelector(e.appendTo)),Y(e.appendTo)&&(n=e.appendTo),Y(n)||(n=document.body)),n})(e).appendChild(n.firstElementChild),t.component},ie=(e,n)=>{const o=document.createElement("div");e.onVanish=()=>{D(null,o),le.delete(a)},e.onAction=n=>{const o=le.get(a);let s;s=e.showInput?{value:a.inputValue,action:n}:n,e.callback?e.callback(s,t.proxy):"cancel"===n||"close"===n?e.distinguishCancelAndClose&&"cancel"!==n?o.reject("close"):o.reject("cancel"):o.resolve(s)};const t=re(e,o,n),a=t.proxy;for(const s in e)U(e,s)&&!U(a.$props,s)&&(a[s]=e[s]);return a.visible=!0,a};function ce(e,n=null){if(!j)return Promise.reject();let o;return K(e)||H(e)?e={message:e}:o=e.callback,new Promise(((t,a)=>{const s=ie(e,null!=n?n:ce._context);le.set(s,{options:e,callback:o,resolve:t,reject:a})}))}const ue={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};["alert","confirm","prompt"].forEach((e=>{ce[e]=function(e){return(n,o,t,a)=>{let s="";return q(o)?(t=o,s=""):s=F(o)?"":o,ce(Object.assign({title:s,message:n,type:"",...ue[e]},t,{boxType:e}),a)}}(e)})),ce.close=()=>{le.forEach(((e,n)=>{n.doClose()})),le.clear()},ce._context=null;const de=ce;de.install=e=>{de._context=e._context,e.config.globalProperties.$msgbox=de,e.config.globalProperties.$messageBox=de,e.config.globalProperties.$alert=de.alert,e.config.globalProperties.$confirm=de.confirm,e.config.globalProperties.$prompt=de.prompt};const pe=de;export{pe as E,ne as i};
