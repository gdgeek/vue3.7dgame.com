import{d as a,aG as t,r as e,aD as s,c as i,o as l,ab as r,e as n,h as o,l as u,w as d,Y as c,bq as p,g as m,f,p as g,B as y,D as h,a1 as v,aP as j,aQ as _,aA as b,a0 as x,b8 as w,br as k,aZ as z,bs as B,bt as C,aw as T}from"./index.D_6c1BO-.js";import{E}from"./el-pagination.iB7W_mBW.js";/* empty css               */import"./el-select.txC_RwMJ.js";import"./el-popper.B126Dx6T.js";import{E as q}from"./el-skeleton-item.P-4Smcyt.js";/* empty css                        */import{M as D,L as A,W as S}from"./index.CRad9h5U.js";import{g as I,d as L,p as M}from"./prefab.4XtTBCmM.js";import{E as R}from"./index.sgqfUYPi.js";import{v as U}from"./v4.aGgpFg1T.js";import"./isEqual._mAmV373.js";import"./_Uint8Array.DVftYLkF.js";import"./index.D3735v7o.js";import"./event.CIKxL71l.js";import"./index.DAlCTFiK.js";import"./strings.BAs9FsGt.js";import"./castArray.Dh6ReS0w.js";import"./index.C9igdc6f.js";/* empty css                 */import"./index.BtcHjPUK.js";import"./aria.D6AGjDMk.js";const W=a=>(j("data-v-7c0c3d5a"),a=a(),_(),a),Y=W((()=>y("br",null,null,-1))),Z=W((()=>y("span",{class:"hidden-sm-and-down"},"创建【元数据】",-1))),G={class:"mrpp-title"},K={class:"card-title",nowrap:""},N={class:"clearfix"},O=W((()=>y("div",{class:"bottom clearfix"},null,-1))),P=W((()=>y("br",null,null,-1))),Q=T(a({__name:"prefabs",setup(a){const j=t(),_=e([]),T=e("-created_at"),W=e(""),Q=e({current:1,count:1,size:20,total:20}),V=s(),$=i((()=>V.userInfo.roles.includes("root"))),F=a=>{T.value=a,ta()},H=a=>{W.value=a,ta()},J=async()=>{try{const a=await R.prompt("请输元数据名称","提示(3-20个字符)",{confirmButtonText:"确定",cancelButtonText:"取消",inputValidator:a=>a?a.length<3?"元数据名称不能小于3个字符":!(a.length>20)||"元数据名称不能大于20个字符":"元数据名称不能为空"});b.success("元数据名称是: "+a.value);const t={title:a.value,custom:1,uuid:U()},e=await M(t);await X(e.data.id)}catch(a){b.info("取消输入")}},X=async a=>{j.push({path:"/meta/prefab-edit",query:{id:a}})},aa=a=>{Q.value.current=a,ta()},ta=async()=>{const a=await I(T.value,W.value,Q.value.current,"image,author");_.value=a.data,await c()};l(ta);const ea=i((()=>_.value.map((a=>({src:a.image.url,id:a.id?a.id.toString():void 0,name:a.title,info:a.info,uuid:a.uuid,image_id:a.image_id,image:a.image,metaResources:a.resources})))));return(a,t)=>{const e=r("font-awesome-icon"),s=x,i=w,l=k,c=r("router-link"),_=z,I=q,M=B,U=E,V=C,X=p;return n(),o("div",null,[Y,u(X,null,{default:d((()=>[u(l,null,{default:d((()=>[u(D,{sorted:m(T),searched:m(W),sortByTime:"created_at",sortByName:"title",onSearch:H,onSort:F},{default:d((()=>[u(i,{inline:!0},{default:d((()=>[m($)?(n(),f(s,{key:0,size:"small",type:"primary",onClick:J},{default:d((()=>[u(e,{icon:"plus"}),Z])),_:1})):g("",!0)])),_:1})])),_:1},8,["sorted","searched"])])),_:1}),u(M,null,{default:d((()=>[u(_,{style:{width:"100%"}},{default:d((()=>[m(ea).length>0?(n(),f(m(S),{key:0,lazyload:!1,width:320,gutter:8,list:m(ea),"column-count":3},{item:d((({item:a})=>[u(_,{style:{width:"320px"},class:"box-card"},{header:d((()=>[y("div",null,[u(_,{shadow:"hover","body-style":{padding:"0px"}},{header:d((()=>[y("span",G,[y("b",K,h(a.name),1)])])),default:d((()=>{return[u(c,{to:(t=a.id,$.value?`/meta/prefab-edit?id=${t}`:"#")},{default:d((()=>[null===a.image?(n(),f(m(A),{key:0,url:"@/assets/image/none.png",style:{width:"100%",height:"270px","object-fit":"contain"}})):(n(),f(m(A),{key:1,style:{width:"100%",height:"270px"},fit:"contain",url:a.image.url},null,8,["url"]))])),_:2},1032,["to"])];var t})),_:2},1024)])])),default:d((()=>[y("div",N,[m($)?(n(),f(i,{key:0,style:{float:"right"},inline:!0},{default:d((()=>[u(s,{onClick:t=>{return e=a.id,void j.push({path:"/meta/prefab-edit",query:{id:e}});var e},size:"small",type:"success",icon:"Edit"},{default:d((()=>[v(" 编辑")])),_:2},1032,["onClick"]),u(s,{onClick:t=>(async a=>{try{await R.confirm("此操作将永久删除该【元数据】, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await L(a),await ta(),b.success("删除成功!")}catch(t){b.info("已取消删除")}})(a.id),size:"small",type:"danger",icon:"Delete"},{default:d((()=>[v(" 删除")])),_:2},1032,["onClick"])])),_:2},1024)):g("",!0)]),O])),_:2},1024),P])),_:1},8,["list"])):(n(),f(I,{key:1}))])),_:1})])),_:1}),u(V,null,{default:d((()=>[u(_,{class:"box-card"},{default:d((()=>[u(U,{"current-page":m(Q).current,"page-count":m(Q).count,"page-size":m(Q).size,total:m(Q).total,layout:"prev, pager, next, jumper",background:"",onCurrentChange:aa},null,8,["current-page","page-count","page-size","total"])])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-7c0c3d5a"]]);export{Q as default};
